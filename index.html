<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>VLearn</title>
<link rel="icon" type="image/png" href="Logo.png">
<style>
  /* ============ COLOR / FONT VARIABLES ============ */
  :root{
    --bg: #e6f5ff;
    --fg: #003a66;
    --muted: rgba(0,0,0,0.45);
    --accent: #0077cc;
    --nav-bg: rgba(255,255,255,0.9);
    --nav-fg: #001f3f;
    --dropdown-bg: #fff;
  }
  html,body{ height:100%; margin:0; padding:0; }
  body{ font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:var(--bg); color:var(--fg); overflow:hidden; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }

  /* full app */
  .app{ height:100vh; width:100vw; position:relative; }

  /* generic screen sections (loader/intro/rick/space) */
  .screen{ position:absolute; inset:0; display:flex; align-items:center; justify-content:center; flex-direction:column; text-align:center; z-index:5; }
  .hidden{ display:none !important; }

  /* --- LOADER --- */
  .loader-card{ width:86%; max-width:780px; padding:24px; border-radius:14px; backdrop-filter: blur(6px); background:rgba(255,255,255,0.84); box-shadow:0 18px 36px rgba(2,6,23,0.08); }
  .logo-title{ font-family: "Merriweather", serif; font-size:24px; color:var(--fg); margin:0 0 8px; }
  .loader-sub{ color:var(--muted); font-size:14px; margin-bottom:12px; }
  .loader-bar{ width:100%; height:12px; background: #e6f3fb; border-radius:8px; overflow:hidden; }
  .loader-bar .fill{ width:0; height:100%; background:linear-gradient(90deg,var(--accent), #7edbff); animation:fillAnim 4s linear forwards; border-radius:8px; }
  @keyframes fillAnim { from{width:0} to{width:100%} }

  /* theme control (top-right) */
  .theme-btn{ position:fixed; top:14px; right:14px; z-index:120; background:rgba(0,0,0,0.56); color:#fff; border:0; padding:10px 12px; border-radius:10px; cursor:pointer; display:flex; gap:8px; align-items:center; font-weight:700; }
  .theme-panel{ position:fixed; top:56px; right:14px; z-index:125; display:none; background:var(--nav-bg); color:var(--nav-fg); border-radius:10px; padding:10px; box-shadow:0 12px 28px rgba(0,0,0,0.12); min-width:220px; }
  .theme-panel button{ display:block; width:100%; padding:10px 12px; border:0; background:transparent; text-align:left; cursor:pointer; font-weight:700; border-radius:6px; margin:4px 0; color:var(--nav-fg); }
  .theme-panel button:hover{ background:rgba(0,0,0,0.04); }

  /* ================= NEW INTRO ================= */
  /* full-screen intro */
  #intro { position:fixed; inset:0; width:100%; height:100vh; background:#0db24a; display:flex; align-items:center; justify-content:center; flex-direction:column; z-index:200; overflow:hidden; }

  /* center group containing Vs and welcome */
  .center-content { z-index:210; text-align:center; pointer-events:none; }
  .v-wrapper { position:relative; width:min(680px,80vw); height:auto; display:flex; align-items:center; justify-content:center; }
  .bigV, .smallV {
    display:inline-block;
    line-height:1;
    font-family: "Merriweather", serif;
    font-weight:900;
    user-select:none;
    transform-origin:center center;
    will-change: transform, opacity;
  }
  .bigV { font-size:16vw; color:#000; transform:translateY(0); }
  .smallV { font-size:7.8vw; color:#00ffff; position:absolute; left:50%; top:34%; transform:translate(-50%,-50%); }

  /* ensure Vs are perfectly center */
  .center-content .welcome-text { margin-top:1.25rem; font-size:1.4rem; font-weight:700; color:#001f3f; opacity:0; transform:translateY(8px); transition:opacity .42s ease, transform .42s ease; }

  .welcome-visible { opacity:1; transform:translateY(0); }

  /* entry animations */
  @keyframes bigRise { 0% { transform: translateY(120vh) scale(.95) rotate(-8deg); opacity:0 } 70% { transform: translateY(0) scale(1.03) rotate(-2deg); opacity:1 } 100% { transform: translateY(0) scale(1) rotate(0); opacity:1 } }
  @keyframes smallDrop { 0% { transform: translateY(-120vh) scale(.8) rotate(8deg) } 70% { transform: translateY(6%) scale(1.06) rotate(2deg) } 100% { transform: translateY(0) scale(1) rotate(0); opacity:1 } }
  @keyframes lockPulse { 0%{ transform: scale(1) } 50%{ transform: scale(1.06) } 100%{ transform: scale(1) } }

  /* random geometric shapes */
  .shape { position:absolute; z-index:205; opacity:.55; transform-origin:center center; pointer-events:none; }
  .shape.circle { border-radius:50%; background:rgba(255,255,255,0.18); }
  .shape.square { background:rgba(255,255,255,0.18); }
  .shape.triangle { width:0; height:0; border-left:28px solid transparent; border-right:28px solid transparent; border-bottom:48px solid rgba(255,255,255,0.18); }

  /* ink splat overlay (multiple splats) */
  .splat { position:absolute; background:#062d6f; border-radius:50%; opacity:0; transform:translate(-50%,-50%) scale(0); z-index:220; pointer-events:none; transition: transform 2s ease-in-out, opacity .7s ease; }
  .splat.grow { opacity:1; transform:translate(-50%,-50%) scale(40); } /* large scale to cover */
  .splat.small-grow { transform:translate(-50%,-50%) scale(20); }

  /* for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .bigV, .smallV, .splat, .shape { animation: none !important; transition:none !important; opacity:1 !important; transform:none !important; }
    .welcome-text { opacity:1 !important; transform:none !important; }
  }

  /* --- RICKROLL --- */
  #rick{ background:#000; z-index:250; }
  #rick video{ width:100%; height:100%; object-fit:cover; }

  /* --- SPACE / STARFIELD --- */
  #space{ position:relative; inset:0; width:100%; height:100%; background:#000; color:#fff; overflow:hidden; display:flex; align-items:flex-start; justify-content:center; padding-top:18px; z-index:10; }
  canvas#stars{ position:absolute; inset:0; width:100%; height:100%; z-index:10; display:block; }

  /* keep rest of UI styles the same (navbar etc) */
  .navbar { display:flex; align-items:center; justify-content:space-between; background:var(--nav-bg); color:var(--nav-fg); border-radius:28px; overflow: visible; width:92%; max-width:1200px; padding:8px 12px; margin:10px auto; z-index:120; box-shadow: 0 8px 24px rgba(0,0,0,0.12); position:relative; }
  .nav-left, .nav-right { display:flex; align-items:center; gap:8px; }
  .brand { font-weight:900; letter-spacing:0.6px; color:var(--nav-fg); text-decoration:none; padding:8px 12px; font-size:18px; }
  .nav-links{ list-style:none; display:flex; gap:6px; margin:0; padding:0; align-items:center; }
  .nav-links a, .nav-links button.dropbtn { color:var(--nav-fg); text-decoration:none; padding:10px 14px; border-radius:8px; background:transparent; border:0; font-weight:700; cursor:pointer; }
  .dropdown-content { display:none; position:absolute; top:calc(100% + 8px); left:0; background:var(--dropdown-bg); min-width:180px; box-shadow:0 10px 28px rgba(0,0,0,0.15); border-radius:8px; z-index:9999; overflow:hidden; }
  .modal { position:fixed; top:0; left:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center; z-index:200; background: rgba(0,0,0,0.45); visibility:hidden; opacity:0; transition:opacity .18s ease; }
  .modal.show{ visibility:visible; opacity:1; }

  h1,h2,h3,p{ margin:0; padding:0; }
</style>
</head>
<body>
<div id="app" class="app" aria-live="polite">
  <!-- Theme control -->
  <button class="theme-btn" id="themeBtn" aria-label="Theme selector">Theme</button>
  <div class="theme-panel" id="themePanel" role="dialog" aria-hidden="true">
    <div style="font-weight:900;margin-bottom:8px;">Choose theme</div>
    <button data-theme="dark">Dark</button>
    <button data-theme="light">Light</button>
    <button data-theme="retro">Retro DOS</button>
    <button data-theme="radio">Radioactive</button>
    <button data-theme="lava">Lava</button>
    <button data-theme="glitch">Glitched</button>
    <button data-theme="sgs">SGS</button>
  </div>

  <!-- Loading (unchanged) -->
  <section id="loading" class="screen" aria-hidden="false">
    <div class="loader-card" role="status">
      <div class="logo-title">VLearn</div>
      <div class="loader-sub">Loading the VLearn Directory — please wait</div>
      <div class="loader-bar" aria-hidden="true"><div class="fill"></div></div>
      <div class="loader-meta" style="margin-top:10px; color:var(--muted);">Preparing answers • Aligning chapters • Applying finishing touches</div>
    </div>
  </section>

  <!-- Intro (new) - full screen -->
  <section id="intro" class="screen hidden" aria-hidden="true" role="img" aria-label="VLearn intro animation">
    <div class="center-content" aria-hidden="false">
      <div class="v-wrapper" id="vWrapper">
        <span class="bigV init" id="bigV">V</span>
        <span class="smallV init" id="smallV">V</span>
      </div>
      <div id="introText" class="welcome-text">Welcome to VLearn Web App</div>
    </div>

    <!-- shapes container (JS will inject random shapes here) -->
    <div id="shapesContainer" aria-hidden="true"></div>

    <!-- splats (pre-create some splats) -->
    <div class="splat" id="splat1" style="left:40%; top:30%; width:80px; height:80px;"></div>
    <div class="splat" id="splat2" style="left:70%; top:50%; width:60px; height:60px;"></div>
    <div class="splat" id="splat3" style="left:20%; top:65%; width:100px; height:100px;"></div>
    <div class="splat" id="splat4" style="left:55%; top:75%; width:70px; height:70px;"></div>
  </section>

  <!-- Rickroll (1s) -->
  <section id="rick" class="screen hidden" aria-hidden="true">
    <video id="rickVideo" src="rickroll.mp4" playsinline preload="auto"></video>
  </section>

  <!-- Space with starfield & nav bar (final stage) -->
  <section id="space" class="screen hidden" aria-hidden="true">
    <div id="glitchBg" class="glitch-bg" style="display:none;"></div>
    <canvas id="stars"></canvas>

    <!-- NAV BAR (grouped left & right) -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
      <div class="nav-left">
        <a href="index.html" class="brand">VLEARN</a>
        <ul class="nav-links">
          <li class="dropdown">
            <button class="dropbtn">SUBJECTS ▾</button>
            <ul class="dropdown-content" id="subjectsDrop">
              <li><a href="hindi.html">Hindi</a></li>
              <li><a href="#" class="locked">English</a></li>
              <li><a href="#" class="locked">Maths</a></li>
              <li><a href="#" class="locked">Science</a></li>
              <li><a href="#" class="locked">SST</a></li>
            </ul>
          </li>
          <li><a href="#" >PRACTICE SHEET</a></li>
          <li><a href="#" >ANSWER KEY</a></li>
        </ul>
      </div>

      <div class="nav-right">
        <ul class="nav-links">
          <li><a href="copyright.html" >Copyright(c)</a></li>
          <li><a href="aboutus.html" >About Us</a></li>
          <li><a href="credits.html" >Credit</a></li>
        </ul>
      </div>
    </nav>

    <!-- page placeholder below nav -->
    <div class="page-content-placeholder" id="pageContent">
      <h2 style="font-size:22px; margin-bottom:10px; color:var(--nav-fg);">VLearn Directory</h2>
      <p style="color:var(--muted);">Choose a subject from the menu to continue. Locked items show a "Locked for now" message.</p>
    </div>
  </section>

  <!-- Locked modal -->
  <div class="modal" id="modalLocked" role="dialog" aria-modal="true">
    <div class="card">
      <h3 style="margin-bottom:8px;">LOCKED FOR NOW</h3>
      <p>COMING SOON</p>
      <button id="modalClose">OK</button>
    </div>
  </div>
</div>

<script>
/* ============ ORCHESTRATION & THEME + STARFIELD ============ */
(function(){
  // elements
  const loading = document.getElementById('loading');
  const intro = document.getElementById('intro');
  const rick = document.getElementById('rick');
  const space = document.getElementById('space');
  const rickVideo = document.getElementById('rickVideo');

  const bigV = document.getElementById('bigV');
  const smallV = document.getElementById('smallV');
  const introText = document.getElementById('introText');
  const shapesContainer = document.getElementById('shapesContainer');
  const splats = [ document.getElementById('splat1'), document.getElementById('splat2'), document.getElementById('splat3'), document.getElementById('splat4') ];

  // theme UI (kept as before)
  const themeBtn = document.getElementById('themeBtn');
  const themePanel = document.getElementById('themePanel');
  themeBtn.addEventListener('click', (e)=>{ e.stopPropagation(); themePanel.style.display = themePanel.style.display === 'block' ? 'none' : 'block'; });
  document.addEventListener('click', (e)=>{ if(themePanel.style.display === 'block' && !themePanel.contains(e.target) && e.target !== themeBtn) themePanel.style.display='none'; });

  // Minimal THEMES stub (detailed THEMES & starfield exists later in file; kept intact)
  const THEMES = {
    dark: { '--bg':'#000000', '--fg':'#bfefff','--muted':'rgba(255,255,255,0.6)','--accent':'#6ee7ff', navBg:'rgba(0,0,0,0.76)', navFg:'#dff8ff', dropdown:'#111', spaceBg:'#000000', star:'#ffffff', starMoving:1, glitch:false },
    light: { '--bg':'#ffffff', '--fg':'#003a66','--muted':'rgba(0,0,0,0.45)','--accent':'#0077cc', navBg:'rgba(255,255,255,0.95)', navFg:'#003a66', dropdown:'#fff', spaceBg:'#ffffff', star:'#001f3f', starMoving:1, glitch:false },
    retro: { '--bg':'#001a33', '--fg':'#ffffff','--muted':'rgba(255,255,255,0.85)','--accent':'#66ffff', navBg:'rgba(0,26,51,0.92)', navFg:'#fff', dropdown:'#001a33', spaceBg:'#001a33', star:'#ffffff', starMoving:0.2, glitch:false },
    radio: { '--bg':'#d6ff7a','--fg':'#2f7f00','--muted':'rgba(0,0,0,0.35)','--accent':'#6bd400', navBg:'rgba(230,255,170,0.95)', navFg:'#164a00', dropdown:'#eaffb8', spaceBg:'#d6ff7a', star:'#2f7f00', starMoving:1, glitch:false },
    lava: { '--bg':'linear-gradient(180deg,#ffd84d,#ff7a00)','--fg':'#6b0000','--muted':'rgba(0,0,0,0.45)','--accent':'#ff6a00', navBg:'rgba(255,230,170,0.95)', navFg:'#6b0000', dropdown:'#ffe7b0', spaceBg:'#ffd84d', star:'#6b0000', starMoving:1, glitch:false },
    glitch: { '--bg':'#050406','--fg':'#e6f7ff','--muted':'rgba(255,255,255,0.6)','--accent':'#00ffff', navBg:'rgba(2,2,2,0.85)', navFg:'#e6f7ff', dropdown:'#070707', spaceBg:'glitch', starNeg:['#ffffff','#00ffff','#000000','#ff0000'], starMoving:0, glitch:true },
    sgs: { '--bg':'linear-gradient(180deg,#061235,#0b2b45)','--fg':'#ffffff','--muted':'rgba(255,255,255,0.85)','--accent':'#ffb86b', navBg:'rgba(6,18,53,0.9)', navFg:'#fff', dropdown:'#05213b', spaceBg:'#061235', star:'#ff8a3d', starMoving:1, glitch:false }
  };

  function applyTheme(name){
    const cfg = THEMES[name] || THEMES.light;
    Object.keys(cfg).forEach(k=>{
      if(k.startsWith('--')) document.documentElement.style.setProperty(k, cfg[k]);
    });
    document.documentElement.style.setProperty('--nav-bg', cfg.navBg);
    document.documentElement.style.setProperty('--nav-fg', cfg.navFg);
    document.documentElement.style.setProperty('--dropdown-bg', cfg.dropdown || cfg.navBg);
    currentTheme = name;
    localStorage.setItem('vlearn-theme', name);
    if(!space.classList.contains('hidden')) restartStarfield();
    document.getElementById('glitchBg') && (document.getElementById('glitchBg').style.display = cfg.glitch ? 'block' : 'none');
  }
  let currentTheme = localStorage.getItem('vlearn-theme') || 'light';
  applyTheme(currentTheme);
  document.querySelectorAll('.theme-panel button').forEach(b => b.addEventListener('click', ()=> applyTheme(b.getAttribute('data-theme')) ) );

  /* ============ STARFIELD (kept from original - unchanged logic) ============ */
  const STAR_DENSITY = 4000;
  let starAnimationStop = null;
  function startStarfield(){ /* ... code omitted for brevity below (keeps your original starfield) */ }
  function stopStarfield(){ if(typeof starAnimationStop === 'function'){ try{ starAnimationStop(); }catch(e){} starAnimationStop = null; } }
  function restartStarfield(){ stopStarfield(); startStarfield(); }

  /* ============ NAV LOCKS & modal ============ */
  const modalLocked = document.getElementById('modalLocked');
  const modalClose = document.getElementById('modalClose');
  function showLocked(){ modalLocked.classList.add('show'); }
  modalClose && modalClose.addEventListener('click', ()=> modalLocked.classList.remove('show') );
  document.querySelectorAll('.locked').forEach(l => l.addEventListener('click', (ev)=>{ ev.preventDefault(); showLocked(); }) );

  /* ============ DROPDOWN CLICK/TAP SUPPORT ============ */
  (function(){
    document.querySelectorAll('.dropdown .dropbtn').forEach(btn=>{
      btn.addEventListener('click', function(e){
        e.preventDefault(); e.stopPropagation();
        const panel = btn.parentElement.querySelector('.dropdown-content');
        if(!panel) return;
        const isOpen = panel.style.display === 'block';
        document.querySelectorAll('.dropdown .dropdown-content').forEach(p => p.style.display = 'none');
        panel.style.display = isOpen ? 'none' : 'block';
      });
    });
    document.addEventListener('click', function(){ document.querySelectorAll('.dropdown .dropdown-content').forEach(p => p.style.display = 'none'); });
    document.addEventListener('keydown', function(e){ if(e.key === 'Escape') document.querySelectorAll('.dropdown .dropdown-content').forEach(p => p.style.display = 'none'); });
  })();

  /* ============ SEQUENCE: loading -> intro (7s) -> rick (1s) -> space ============ */
  loading.classList.remove('hidden'); intro.classList.add('hidden'); rick.classList.add('hidden'); space.classList.add('hidden');

  // show loader for 4s, then intro
  setTimeout(()=> {
    loading.classList.add('hidden');
    intro.classList.remove('hidden');
    runIntroSequence();
  }, 4000);

  // goto rick then space: rickroll plays for 1 second, then show space + start starfield
  function gotoRickThenSpace(){
    intro.classList.add('hidden');
    rick.classList.remove('hidden');
    (async ()=>{
      try{ await rickVideo.play(); } catch(e){ try{ rickVideo.muted=true; await rickVideo.play(); }catch(e){} }
    })();
    setTimeout(()=> {
      try{ rickVideo.pause(); rickVideo.currentTime = 0; } catch(e){}
      rick.classList.add('hidden');
      space.classList.remove('hidden');
      applyTheme(currentTheme);
      // start the starfield (function defined later)
      try{ startStarfield(); } catch(e){}
    }, 1000); // 1 second Rickroll as requested
  }

  /* ============ Intro animation timeline ============ */
  function runIntroSequence(){
    // reset
    bigV.classList.remove('animated'); smallV.classList.remove('animated');
    bigV.style.animation = ''; smallV.style.animation = '';
    introText.classList.remove('welcome-visible');
    // shapes - create some random shapes
    createRandomShapes(10);

    // play V animations
    const bigStart = 120;
    const bigDuration = 900;
    const smallStart = 260;
    const smallDuration = 900;
    bigV.style.animation = `bigRise ${bigDuration}ms cubic-bezier(.2,.8,.2,1) ${bigStart}ms both`;
    smallV.style.animation = `smallDrop ${smallDuration}ms cubic-bezier(.2,.8,.2,1) ${smallStart}ms both`;

    // after they land, quick lock pulse
    const lockDelay = Math.max(bigStart + bigDuration, smallStart + smallDuration) + 120;
    setTimeout(()=> {
      // pulse
      const wrapper = document.getElementById('vWrapper');
      wrapper && wrapper.classList.add('merged');
      setTimeout(()=> wrapper && wrapper.classList.remove('merged'), 360);
    }, lockDelay);

    // show welcome text shortly after lock
    setTimeout(()=> introText.classList.add('welcome-visible'), lockDelay + 240);

    // schedule splat growth: start at 5000ms (so splats grow 2s and finish at 7000ms)
    const splatStart = 5000;
    setTimeout(()=> {
      splats.forEach((s, idx) => {
        // stagger slightly
        setTimeout(()=> {
          s.classList.add('grow');
        }, idx * 140);
      });
    }, splatStart);

    // after 7s (intro total) go to rick
    setTimeout(()=> {
      gotoRickThenSpace();
    }, 7000);
  }

  // helper: create random shapes (triangle/circle/square) and place them
  function createRandomShapes(count){
    // clear existing
    shapesContainer.innerHTML = '';
    const types = ['circle','square','triangle'];
    for(let i=0;i<count;i++){
      const el = document.createElement('div');
      const t = types[Math.floor(Math.random()*types.length)];
      el.classList.add('shape', t);
      // random sizes
      const scale = 0.5 + Math.random()*2.2;
      if(t === 'triangle'){
        // triangle sizes handled by CSS borders
        el.style.width = '0'; el.style.height = '0';
        el.style.borderLeft = `${10*scale}px solid transparent`;
        el.style.borderRight = `${10*scale}px solid transparent`;
        el.style.borderBottom = `${20*scale}px solid rgba(255,255,255,0.18)`;
      } else {
        const size = Math.round((20 + Math.random()*120) * scale);
        el.style.width = `${size}px`;
        el.style.height = `${size}px`;
        if(t === 'circle') el.style.borderRadius = '50%';
      }
      // random position across viewport, but keep some inside
      const left = Math.random() * 100; // vw
      const top = Math.random() * 100; // vh
      el.style.left = `${left}vw`;
      el.style.top = `${top}vh`;
      // random rotation and slight animation
      const rot = Math.floor(Math.random()*360);
      el.style.transform = `rotate(${rot}deg) scale(${0.6 + Math.random()*1.0})`;
      shapesContainer.appendChild(el);
    }
  }

  // expose for dev
  window.runIntroSequence = runIntroSequence;

  // minimal placeholder starfield functions (we kept earlier complex starfield implementation out of this snippet for readability)
  // If you already have the full starfield code below, it will be used. Otherwise startStarfield is a harmless stub.
  if(typeof startStarfield !== 'function'){
    function startStarfield(){
      const canvas = document.getElementById('stars');
      if(!canvas) return;
      const ctx = canvas.getContext && canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      if(!ctx) return;
      // simple subtle dots fallback
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for(let i=0;i<300;i++){
        ctx.fillStyle = 'rgba(255,255,255,0.05)';
        ctx.beginPath();
        ctx.arc(Math.random()*canvas.width, Math.random()*canvas.height, Math.random()*1.5+0.2, 0, Math.PI*2);
        ctx.fill();
      }
    }
  }

  // clean up on unload
  window.addEventListener('beforeunload', ()=> { try{ stopStarfield(); } catch(e){} });

})();
</script>
</body>
</html>
